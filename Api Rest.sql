-- Crear el usuario 
CREATE USER apirest IDENTIFIED BY api
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
QUOTA UNLIMITED ON users;

-- Dar privilegios b√°sicos para conectarse y trabajar con sus tablas
GRANT CREATE SESSION TO apirest ;
GRANT CREATE TABLE TO apirest ;
GRANT CREATE SEQUENCE TO apirest ;
GRANT CREATE VIEW TO apirest;

-- ================================================
-- Ahora conectarse con el nuevo usuario (con SQL Developer):
-- ================================================

-- Creamos la tabla EMPRESA
CREATE TABLE EMPRESA (
    IDEMPRESA NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRE VARCHAR2(50) NOT NULL
);
COMMENT ON TABLE EMPRESA IS 'TABLA CON LAS EMPRESAS';
COMMENT ON COLUMN EMPRESA.IDEMPRESA IS 'LLAVE PRIMARIA DE LA TABLA EMPRESA';
COMMENT ON COLUMN EMPRESA.NOMBRE IS 'NOMBRE DE LA EMPRESA';

-- Creamos la tabla DEPARTAMENTO
CREATE TABLE DEPARTAMENTO (
    IDDEPARTAMENTO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    IDEMPRESA NUMBER,
    NOMBRE VARCHAR2(50) NOT NULL
);
ALTER TABLE DEPARTAMENTO ADD CONSTRAINT FK_DEPARTAMENTO_EMPRESA FOREIGN KEY (IDEMPRESA) REFERENCES EMPRESA(IDEMPRESA);
COMMENT ON TABLE DEPARTAMENTO IS 'TABLA QUE CONTIENE LOS DEPARTAMENTOS DE UNA EMPRESA';
COMMENT ON COLUMN DEPARTAMENTO.IDDEPARTAMENTO IS 'LLAVE PRIMARIA DE LA TABLA DEPARTAMENTO';
COMMENT ON COLUMN DEPARTAMENTO.IDEMPRESA IS 'LLAVE FORANEA QUE APUNTA A LA TABLA EMPRESA';
COMMENT ON COLUMN DEPARTAMENTO.NOMBRE IS 'NOMBRE DEL DEPARTAMENTO';

-- Creamos la tabla EMPLEADO
CREATE TABLE EMPLEADO (
    IDEMPLEADO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    IDDEPARTAMENTO NUMBER NOT NULL,
    NOMBRE VARCHAR2(50) NOT NULL,
    EDAD NUMBER NOT NULL,
    FECHANACIMIENTO DATE NOT NULL    
);
ALTER TABLE EMPLEADO ADD CONSTRAINT FK_EMPLEADO_DEPARTAMENTO FOREIGN KEY (IDDEPARTAMENTO) REFERENCES DEPARTAMENTO(IDDEPARTAMENTO);
COMMENT ON TABLE EMPLEADO IS 'TABLA QUE CONTIENE LOS EMPLEADOS DE LOS DEPARTAMENTOS';
COMMENT ON COLUMN EMPLEADO.IDEMPLEADO IS 'LLAVE PRIMARIA DE LA TABLA EMPLEADO';
COMMENT ON COLUMN EMPLEADO.IDDEPARTAMENTO IS 'LLAVE FORANEA QUE APUNTA A LA TABLA DEPARTAMENTO';
COMMENT ON COLUMN EMPLEADO.NOMBRE IS 'NOMBRE DEL EMPLEADO';
COMMENT ON COLUMN EMPLEADO.EDAD IS 'EDAD DEL EMPLEADO';
COMMENT ON COLUMN EMPLEADO.FECHANACIMIENTO IS 'FECHA DE NACIMIENTO DEL EMPLEADO';


COMMIT;


SELECT * FROM EMPRESA;
SELECT * FROM DEPARTAMENTO;
SELECT * FROM EMPLEADO;
